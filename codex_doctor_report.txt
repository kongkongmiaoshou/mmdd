
========================================================================
Codex 网络体检 (WSL) - 自动报告
========================================================================
time: 2026-02-14 17:30:56 UTC
cwd : /home/administrator/codex_work

========================================================================
系统信息
========================================================================
Linux PC 6.6.87.2-microsoft-standard-WSL2 #1 SMP PREEMPT_DYNAMIC Thu Jun  5 18:30:46 UTC 2025 x86_64 x86_64 x86_64 GNU/Linux
PRETTY_NAME="Ubuntu 24.04.4 LTS"
NAME="Ubuntu"
VERSION_ID="24.04"
VERSION="24.04.4 LTS (Noble Numbat)"
VERSION_CODENAME=noble
ID=ubuntu

========================================================================
路由与地址
========================================================================

$ ip -4 addr show
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq state UP group default qlen 1000
    inet 172.22.171.51/20 brd 172.22.175.255 scope global eth0
       valid_lft forever preferred_lft forever

$ ip -6 addr show
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 state UNKNOWN qlen 1000
    inet6 ::1/128 scope host 
       valid_lft forever preferred_lft forever
2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 state UP qlen 1000
    inet6 fe80::215:5dff:fe2a:1b8/64 scope link 
       valid_lft forever preferred_lft forever

$ ip route
default via 172.22.160.1 dev eth0 proto kernel 
172.22.160.0/20 dev eth0 proto kernel scope link src 172.22.171.51

$ ip -6 route
fe80::/64 dev eth0 proto kernel metric 256 pref medium

========================================================================
DNS 配置
========================================================================
/etc/resolv.conf:
# This file was automatically generated by WSL. To stop automatic generation of this file, add the following entry to /etc/wsl.conf:
# [network]
# generateResolvConf = false
nameserver 172.22.160.1

========================================================================
代理环境变量
========================================================================
__NO_PROXY_ENV__

========================================================================
系统解析结果 (socket.getaddrinfo)
========================================================================

openai.com
  A    : 104.18.33.45, 172.64.154.211
  AAAA : -

auth.openai.com
  A    : 104.18.41.241, 172.64.146.15
  AAAA : 2606:4700:4406::6812:29f1, 2a06:98c1:3106::ac40:920f

platform.openai.com
  A    : 104.18.33.45, 172.64.154.211
  AAAA : 2a06:98c1:3103::ac40:9ad3, 2a06:98c1:310d::6812:212d

api.openai.com
  A    : 202.160.129.6
  AAAA : 2a03:2880:f126:83:face:b00c:0:25de

========================================================================
对比公共 DNS (UDP/53) - 1.1.1.1 与 8.8.8.8
========================================================================

openai.com  via 1.1.1.1
  A    : FAIL(timed out)
  AAAA : FAIL(timed out)

openai.com  via 8.8.8.8
  A    : 104.18.33.45, 172.64.154.211
  AAAA : -

auth.openai.com  via 1.1.1.1
  A    : FAIL(timed out)
  AAAA : FAIL(timed out)

auth.openai.com  via 8.8.8.8
  A    : 104.18.41.241, 172.64.146.15
  AAAA : 2606:4700:4406::6812:29f1, 2a06:98c1:3106::ac40:920f

platform.openai.com  via 1.1.1.1
  A    : FAIL(timed out)
  AAAA : FAIL(timed out)

platform.openai.com  via 8.8.8.8
  A    : 172.64.154.211, 104.18.33.45
  AAAA : 2a06:98c1:3103::ac40:9ad3, 2a06:98c1:310d::6812:212d

api.openai.com  via 1.1.1.1
  A    : FAIL(timed out)
  AAAA : FAIL(timed out)

api.openai.com  via 8.8.8.8
  A    : 199.16.158.8
  AAAA : 2a03:2880:f11b:83:face:b00c:0:25de

========================================================================
纯 TCP 出口连通 (IPv4) - 只测端口 443
========================================================================
1.1.1.1:443 -> FAIL (timed out)
8.8.8.8:443 -> FAIL (timed out)
9.9.9.9:443 -> FAIL (timed out)

========================================================================
关键域名端口连通 (优先用系统解析出来的 IP)
========================================================================
openai.com -> 104.18.33.45:443 -> OK
openai.com -> 172.64.154.211:443 -> OK
auth.openai.com -> 104.18.41.241:443 -> OK
auth.openai.com -> 172.64.146.15:443 -> OK
auth.openai.com -> 2606:4700:4406::6812:29f1:443 -> FAIL ([Errno 101] Network is unreachable)
auth.openai.com -> 2a06:98c1:3106::ac40:920f:443 -> FAIL ([Errno 101] Network is unreachable)
platform.openai.com -> 104.18.33.45:443 -> OK
platform.openai.com -> 172.64.154.211:443 -> OK
platform.openai.com -> 2a06:98c1:3103::ac40:9ad3:443 -> FAIL ([Errno 101] Network is unreachable)
platform.openai.com -> 2a06:98c1:310d::6812:212d:443 -> FAIL ([Errno 101] Network is unreachable)
api.openai.com -> 202.160.129.6:443 -> FAIL (timed out)
api.openai.com -> 2a03:2880:f126:83:face:b00c:0:25de:443 -> FAIL ([Errno 101] Network is unreachable)

========================================================================
快速判断与最小改动建议
========================================================================
结论信号：
- IPv4 出口 (TCP/443 到公共地址): FAIL
- api.openai.com 端口连通: FAIL
- 系统 DNS 与公共 DNS 明显不一致: YES

建议（按优先级，尽量少改动）：
1) 先修 DNS：你的系统解析结果和公共 DNS 不一致，疑似 DNS 劫持/污染。
   方案A（推荐）：在 Windows 侧把 DNS 改成 1.1.1.1 / 8.8.8.8 后重启 WSL。
   方案B：在 WSL 固定 resolv.conf（需要 wsl.conf + wsl --shutdown）。
2) IPv4 出口异常：WSL 里连 1.1.1.1:443 都不通。优先检查：VPN/代理/安全软件/公司网络策略/Windows 防火墙对 WSL 的限制。
   你可以先在 Windows PowerShell 测：Test-NetConnection 1.1.1.1 -Port 443

若你把这份 codex_doctor_report.txt 截图/贴出关键几段，我可以据此给你唯一的最短修复路径。
